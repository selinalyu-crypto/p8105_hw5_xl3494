p8105_hw5_xl3494
================
Selina Lyu

## Problem 1

Write a function that, for a fixed group size, randomly draws
“birthdays” for each person; checks whether there are duplicate
birthdays in the group; and returns TRUE or FALSE based on the result.

``` r
share_birthday = function(n) {
  
  birthdays = sample(1:365, size = n, replace = TRUE) 
  return(length(unique(birthdays)) < n)           
  
  }
```

Next, run this function 10000 times for each group size between 2 and
50. For each group size, compute the probability that at least two
people in the group will share a birthday by averaging across the 10000
simulation runs.

``` r
prob_results = 
  expand_grid(
    group_size = 2:50,
    iter = 1:10000) |> 
  mutate(
    share = map_lgl(group_size, share_birthday)) |>
  group_by(group_size) |>
  summarize(prob_share = mean(share))

prob_results
```

    ## # A tibble: 49 × 2
    ##    group_size prob_share
    ##         <int>      <dbl>
    ##  1          2     0.0024
    ##  2          3     0.0085
    ##  3          4     0.0167
    ##  4          5     0.0267
    ##  5          6     0.0399
    ##  6          7     0.0521
    ##  7          8     0.0751
    ##  8          9     0.0925
    ##  9         10     0.116 
    ## 10         11     0.139 
    ## # ℹ 39 more rows

Make a plot showing the probability as a function of group size, and
comment on your results.

``` r
ggplot(prob_results, aes(x = group_size, y = prob_share)) +
  geom_line() +
  geom_point() +
  labs(
    title = "Probability of Shared Birthday vs Group Size",
    x = "Group Size (Number of People)",
    y = "Probability"
  )
```

<img src="p8105_hw5_xl3494_files/figure-gfm/unnamed-chunk-4-1.png" width="90%" />
This plot shows the probabilities that at least two people share a
birthday for group size of 2 to 50. When group size is small (\<15), the
probabilities are low. The increase in probabilities becomes faster when
group size increases to 15-35. The probabilities approach to 1 as the
group size further increases to 50.
